<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>HeartMail âœ¨</title>
    <style>
        /* --- ENHANCED AESTHETIC CSS --- */
        * { box-sizing: border-box; }
        
        body { 
            margin: 0; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #ffdee9 0%, #b5fffc 100%); 
            display: flex; 
            height: 100vh; 
            color: #590d22;
            overflow: hidden;
        }

        .app-container {
            display: flex;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(10px);
        }

        /* --- SIDEBAR --- */
        .sidebar { 
            width: 260px; 
            background: rgba(255, 255, 255, 0.6); 
            border-right: 1px solid rgba(255, 255, 255, 0.8); 
            padding: 20px; 
            display: flex;
            flex-direction: column;
            gap: 10px;
            overflow-y: auto;
        }

        .logo {
            text-align: center;
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(45deg, #ff9a9e, #fad0c4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            text-shadow: 0 2px 10px rgba(255, 154, 158, 0.3);
        }

        .compose-btn { 
            background: linear-gradient(45deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%);
            border: none; padding: 15px 25px; border-radius: 50px; 
            font-weight: bold; color: #fff; cursor: pointer; 
            display: flex; align-items: center; justify-content: center; gap: 10px; 
            transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(255, 154, 158, 0.4);
            font-size: 1.1rem; margin-bottom: 20px;
        }
        .compose-btn:hover { transform: translateY(-2px) scale(1.05); box-shadow: 0 6px 20px rgba(255, 154, 158, 0.6); }

        .nav-section {
            margin-bottom: 25px;
        }

        .nav-section-title {
            font-size: 0.75rem;
            text-transform: uppercase;
            color: #999;
            font-weight: bold;
            margin-bottom: 8px;
            padding-left: 10px;
            letter-spacing: 1px;
        }

        .nav-item { 
            padding: 12px 20px; cursor: pointer; border-radius: 15px; 
            transition: all 0.2s; font-weight: 500; color: #888; display: flex; justify-content: space-between; align-items: center;
        }
        .nav-item:hover { background: rgba(255, 255, 255, 0.5); color: #ff4d6d; }
        .nav-item.active { background: #fff0f3; color: #ff4d6d; font-weight: bold; box-shadow: inset 0 0 0 2px #ffccd5; }

        .badge {
            background: #ff4d6d;
            color: white;
            border-radius: 10px;
            padding: 2px 8px;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .label-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 20px;
            cursor: pointer;
            border-radius: 12px;
            transition: all 0.2s;
            color: #666;
            font-size: 0.95rem;
        }
        .label-item:hover {
            background: rgba(255, 255, 255, 0.5);
        }
        .label-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        /* --- MAIN AREA --- */
        .main { 
            flex: 1; display: flex; flex-direction: column; 
            background: rgba(255, 255, 255, 0.8); margin: 15px; border-radius: 25px; 
            overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.05); 
            border: 1px solid rgba(255, 255, 255, 0.9); position: relative;
        }

        /* --- TOOLBAR --- */
        .toolbar {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 25px;
            border-bottom: 1px solid #ffe5ec;
            background: rgba(255, 255, 255, 0.9);
        }

        .search-box {
            flex: 1;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 10px 40px 10px 40px;
            border: 1px solid #ffe5ec;
            border-radius: 25px;
            outline: none;
            font-family: inherit;
            transition: all 0.2s;
        }
        .search-box input:focus {
            border-color: #ff9a9e;
            box-shadow: 0 0 0 3px rgba(255, 154, 158, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }

        .toolbar-btn {
            background: transparent;
            border: 1px solid #ffe5ec;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
            color: #666;
        }
        .toolbar-btn:hover {
            background: #fff0f3;
            border-color: #ffccd5;
            color: #ff4d6d;
        }

        .email-list { overflow-y: auto; flex: 1; padding: 10px; }

        .email-item { 
            display: flex; align-items: center; padding: 15px; 
            border-bottom: 1px solid #ffe5ec; cursor: pointer; 
            transition: all 0.2s; border-radius: 15px; margin-bottom: 5px;
            position: relative;
        }
        .email-item:hover { background: #fff; transform: scale(0.99); box-shadow: 0 4px 10px rgba(255, 77, 109, 0.1); }
        .email-item.unread { background: rgba(255, 255, 255, 0.5); font-weight: bold; }
        .email-item.unread .subject { color: #ff4d6d; }

        .checkbox {
            width: 20px;
            height: 20px;
            margin-right: 15px;
            cursor: pointer;
            accent-color: #ff4d6d;
        }

        .star-btn {
            font-size: 1.2rem; color: #ddd; margin-right: 15px; cursor: pointer; transition: 0.2s;
        }
        .star-btn:hover { color: #ffccd5; }
        .star-btn.active { color: #ffbf00; text-shadow: 0 0 5px #ffea00; }

        .sender { width: 180px; font-weight: bold; color: #590d22; }
        .subject { flex: 1; color: #666; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .preview { color: #999; font-weight: normal; font-size: 0.9rem; }
        .date { width: 120px; text-align: right; font-size: 0.8rem; color: #ff8fa3; font-weight: bold; }

        .label-tag {
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            margin-left: 8px;
            font-weight: bold;
        }

        /* --- READING PANE --- */
        .email-view { display: none; padding: 40px; flex-direction: column; height: 100%; background: #fff; animation: fadeIn 0.3s; overflow-y: auto; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .view-header { border-bottom: 2px dashed #ffccd5; padding-bottom: 20px; margin-bottom: 25px; display: flex; align-items: center; justify-content: space-between; }
        
        .view-title {
            display: flex;
            align-items: center;
            flex: 1;
        }

        .back-btn { 
            background: #ffe5ec; border: none; width: 40px; height: 40px; border-radius: 50%;
            font-size: 1.2rem; cursor: pointer; margin-right: 20px; color: #ff4d6d;
            transition: 0.2s; display: flex; align-items: center; justify-content: center;
        }
        .back-btn:hover { background: #ff4d6d; color: #fff; }

        .view-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            background: #fff0f3;
            border: none;
            padding: 10px 18px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            color: #ff4d6d;
            font-family: inherit;
            font-weight: 500;
        }
        .action-btn:hover {
            background: #ff4d6d;
            color: white;
            transform: translateY(-2px);
        }

        .avatar { 
            width: 50px; height: 50px; 
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%);
            border-radius: 50%; color: white; display: flex; align-items: center; justify-content: center; 
            font-size: 1.5rem; font-weight: bold; box-shadow: 0 4px 10px rgba(255, 154, 158, 0.5);
        }

        #e-body { 
            line-height: 1.8; color: #555; font-size: 1.05rem; background: #fffafa; 
            padding: 25px; border-radius: 15px; border: 1px solid #fff0f3; 
        }

        .reply-box {
            margin-top: 30px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 15px;
            border: 2px dashed #ffccd5;
        }

        .reply-textarea {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 1px solid #ffe5ec;
            border-radius: 12px;
            font-family: inherit;
            outline: none;
            resize: vertical;
        }
        .reply-textarea:focus {
            border-color: #ff9a9e;
            box-shadow: 0 0 0 3px rgba(255, 154, 158, 0.1);
        }

        .reply-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            justify-content: flex-end;
        }

        /* --- COMPOSE MODAL --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.6); backdrop-filter: blur(5px);
            display: none; align-items: center; justify-content: center; z-index: 100;
        }
        .compose-box {
            width: 650px; height: 550px; background: white; border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1); border: 1px solid #ffccd5;
            display: flex; flex-direction: column; overflow: hidden; animation: popUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popUp { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        .compose-header { background: #fff0f3; padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; font-weight: bold; color: #ff4d6d; }
        .compose-form { padding: 20px; display: flex; flex-direction: column; flex: 1; gap: 15px; }
        .c-input { padding: 12px; border: 1px solid #eee; border-radius: 10px; outline: none; transition: 0.2s; font-family: inherit; }
        .c-input:focus { border-color: #ff9a9e; box-shadow: 0 0 0 3px rgba(255,154,158,0.1); }
        .c-body { flex: 1; resize: none; }
        .c-footer { display: flex; justify-content: space-between; align-items: center; }
        .c-footer-left {
            display: flex;
            gap: 10px;
        }
        .c-footer-right {
            display: flex;
            gap: 10px;
        }
        .icon-btn {
            background: transparent;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.2s;
            color: #999;
        }
        .icon-btn:hover {
            background: #fff0f3;
            color: #ff4d6d;
        }
        .btn-cancel { background: transparent; border: none; color: #888; cursor: pointer; padding: 10px 20px; }
        .btn-send { background: #ff4d6d; color: white; border: none; padding: 10px 30px; border-radius: 30px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 10px rgba(255, 77, 109, 0.3); }
        .btn-send:hover { transform: scale(1.05); }

        /* Notification Toast */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: white;
            padding: 15px 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            border-left: 4px solid #ff4d6d;
            display: none;
            align-items: center;
            gap: 15px;
            animation: slideIn 0.3s ease;
            z-index: 1000;
        }
        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: #aaa;
        }
        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        /* Attachment preview */
        .attachment {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #f0f0f0;
            padding: 8px 15px;
            border-radius: 20px;
            margin-top: 15px;
            font-size: 0.9rem;
            color: #666;
            cursor: pointer;
            transition: all 0.2s;
        }
        .attachment:hover {
            background: #e5e5e5;
        }
    </style>

<!-- HeartOS i18n -->
<script>
window.__translations = {
    en: {
        compose: "âœ¨ Compose", inbox: "ğŸ’– Inbox", starred: "â­ Starred",
        sent: "ğŸ’… Sent", drafts: "ğŸ“ Drafts", important: "ğŸ”¥ Important",
        trash: "ğŸ—‘ï¸ Trash", labels: "Labels",
        personal: "Personal", work: "Work", hobby: "Hobby", shopping: "Shopping",
        search_mail: "Search mail...", select_all: "Select All",
        delete: "ğŸ—‘ï¸ Delete", mark_read: "âœ“ Mark Read",
        star_btn: "â­ Star", reply: "â†©ï¸ Reply", forward: "â¡ï¸ Forward",
        reply_placeholder: "Type your reply...", cancel: "Cancel",
        send_reply: "Send Reply âœ¨", new_message: "âœ¨ New Message",
        to_placeholder: "To: (e.g., Babe, Mom, Coach)",
        subject_placeholder: "Subject:",
        message_placeholder: "Type your message here...",
        save_draft: "Save Draft", send: "Send âœ¨",
        nothing_here: "Nothing here!",
        no_match: "No emails match your search.",
        folder_empty: "Your folder is empty.",
        trash_empty: "Trash is empty! You are sustainable! â™»ï¸",

        toast_no_selected: "No emails selected!",
        toast_deleted_n: "Deleted {n} email(s)!",
        toast_mark_read: "Marked as read!",
        toast_delete_confirm: "Delete {n} email(s)?",
        toast_delete_one_confirm: "Delete this email?",
        toast_write_first: "Write something first!",
        toast_reply_sent: "Reply sent!",
        toast_recipient_subject: "Add a recipient and subject!",
        toast_sent_manifest: "Sent! Manifesting a reply.",
        toast_nothing_save: "Nothing to save!",
        toast_draft_saved: "Draft saved!",
        toast_star_added: "Added to starred!",
        toast_star_removed: "Removed from starred",

        soon_attach: "Attachment feature coming soon!",
        soon_emoji: "Emoji picker coming soon!",
        soon_schedule: "Schedule send coming soon!",

        // â”€â”€ INBOX EMAILS â”€â”€

        email1_subject: "ğŸ¾ Whippet Litter â€” 1 Puppy Left",
        email1_body: "Hi there!<br><br>Great news â€” our latest whippet litter is almost fully reserved, but there's <b>one blue fawn girl</b> still looking for her person. She's got the longest ears you've ever seen and she already does the classic whippet loaf on the couch.<br><br>Photos attached. She won't last long.<br><br>â€“ Paws & Noses Kennel",

        email2_subject: "ğŸ‘ Practice Moved to 19:30",
        email2_body: "Hey team!<br><br>Hall is double-booked (again ğŸ™„). Practice tonight is pushed to <b>7:30 PM</b>.<br><br>Bring your sticks, bring your A-game, bring snacks if you're feeling generous.<br><br>See you on the court! ğŸ’ª<br>â€“ Coach K",

        email3_subject: "Your streak is in danger ğŸ”¥",
        email3_body: "Hey,<br><br>You've been learning Czech for <b>47 days straight</b>. Don't break it now. That's longer than most New Year's resolutions last.<br><br>Today's lesson: Food vocabulary. Finally learn what you've been ordering at restaurants.<br><br>ğŸ¦‰ Duo",

        email4_subject: "âœ¨ Why You Don't Need That New Serum",
        email4_body: "New video is UP:<br><br><b>'My Low-Buy Year: How I Saved â‚¬400 & Cleared My Skin'</b><br><br>Spoiler: the secret ingredient was literally just water and leaving your face alone. Revolutionary, I know.<br><br>Stay glowing (naturally),<br>â€“ The Daily Glow",

        email5_subject: "ğŸ¼ Red Panda Feeding Experience â€” You're Invited!",
        email5_body: "Dear friend,<br><br>Thank you for your recent donation to the Red Panda Conservation Fund! ğŸ‰<br><br>As a thank you, we'd love to invite you to an <b>exclusive behind-the-scenes feeding session</b> next month. You'll get to meet Bamboo and Mochi â€” our two resident red pandas who are basically professional snack thieves.<br><br>Please reply to confirm your spot.<br><br>â€“ Prague Zoo Conservation Team",

        email6_subject: "Fourth Wing is Trending Again ğŸ‰",
        email6_body: "Your weekly Goodreads update:<br><br>Everyone you know is reading <b>Fourth Wing</b>. You marked it as 'Want to Read' 4 months ago. The book is staring at you. Judgingly.<br><br>Rating: â­â­â­â­â­ (5.0)<br>Top review: <i>'Literally spicy Hunger Games with dragons. I read it in one sitting and forgot to eat.'</i><br><br>No pressure though.",

        email7_subject: "Pins You Might Love ğŸ“Œ",
        email7_body: "Based on your board <b>'Future Home'</b> we found some pins for you:<br><br>â€¢ Minimalist beige living rooms that cost more than your rent<br>â€¢ Whippet puppy photography (you're welcome)<br>â€¢ Vegan meal prep that actually looks edible<br>â€¢ Cozy reading nooks you'll screenshot but never build<br><br>â€“ Pinterest",

        email8_subject: "New 2026 Templates Are Here",
        email8_body: "Organize your entire existence with our new template pack:<br><br>ğŸ“‹ Gym Tracker (for that membership you're definitely using)<br>ğŸ§´ Skincare Routine Log (3 steps max, we promise)<br>ğŸ“š Reading List (so you stop buying books you already own)<br>ğŸ• Pet Care Dashboard (yes, this exists now)<br><br>All free. No excuses.<br>â€“ Notion",

        email9_subject: "20% Off Seamless Leggings ğŸƒâ€â™€ï¸",
        email9_body: "Look, we know you said you're doing a low-buy year.<br><br>But these leggings have <b>pockets</b>. REAL pockets. Phone-sized pockets.<br><br>20% off this weekend only. Use code: POCKETS20<br><br>We support you either way. ğŸ’ª<br>â€“ GymShark",

        email10_subject: "Your February Wrapped ğŸµ",
        email10_body: "You listened to <b>12,458 minutes</b> of music this month. That's... a lot.<br><br>Your Top Artists:<br>1. Taylor Swift (surprised? no one is)<br>2. Olivia Rodrigo<br>3. Sabrina Carpenter<br><br>Your Vibe: <b>Main Character Energy</b> âœ¨<br>Your most-played time: 2 AM (are you okay?)<br><br>â€“ Spotify",

        email11_subject: "3 Jobs That Match Your Profile ğŸ’¼",
        email11_body: "Based on your skills and experience, we found these roles:<br><br>â€¢ <b>Senior Bed Tester</b> @ Google â€” Remote, great benefits<br>â€¢ <b>Professional Nap Coordinator</b> @ Figma â€” Flexible hours<br>â€¢ <b>Chief Sleep Officer</b> @ Notion â€” Unlimited PTO<br><br>These won't last long. (Neither will your patience with LinkedIn emails.)<br><br>â€“ LinkedIn",

        email12_subject: "âš¡ FLASH SALE: Apple Chips",
        email12_body: "ATTENTION LOYAL CUSTOMER,<br><br>This weekend ONLY: <b>Apple chips at 15% off</b> at Lidl Ostrava.<br><br>Show this email at checkout. Or screenshot it. Or just show up and hope for the best, honestly the cashiers don't check.<br><br>ğŸ Lidl â€” Big on quality, small on prices, medium on email marketing.",

        email13_subject: "Time for a Haircut? ğŸ’‡â€â™€ï¸",
        email13_body: "Hi!<br><br>It's been 3 months since your last visit. Your hair called â€” it misses us. (Just kidding. That would be creepy.)<br><br>Book your next appointment and get <b>15% off</b> any Redken treatment.<br><br>Use code: FRESHCUT<br><br>â€“ Studio R, Prague",

        email14_subject: "You Left Something in Your Cart ğŸ‘€",
        email14_body: "Hey,<br><br>That <b>cozy oversized blanket hoodie</b> is still in your cart. It's been there for 3 days. It's getting cold. It's lonely.<br><br>Just saying â€” free shipping ends tonight.<br><br>No pressure. (A little pressure.)<br><br>â€“ ASOS",

        email15_subject: "ğŸ§˜ Your Weekly Wellness Summary",
        email15_body: "Here's your week in review:<br><br>ğŸƒ Steps: 48,291 (nice!)<br>ğŸ˜´ Avg Sleep: 6.2 hours (not nice)<br>ğŸ’§ Water intake: Who knows, you stopped logging on Tuesday<br>ğŸ§˜ Meditation: 0 minutes (the app is right there)<br><br>Keep going! Or start going. Either works.<br><br>â€“ Fitbit",

        // â”€â”€ SENT EMAILS â”€â”€

        email_sent1_subject: "Re: Whippet Litter",
        email_sent1_body: "OH MY GOD. ğŸ˜­<br><br>Yes please! I absolutely want to meet her. Is Saturday morning okay? I'm already emotionally attached from the photos alone.<br><br>Please don't let anyone else have her.",

        email_sent2_subject: "Re: Red Panda Experience",
        email_sent2_body: "YES. I am literally free every single day next month for this. Name the time and I'll be there.<br><br>Quick question: am I allowed to cry when I meet them? Asking for myself.",

        email_sent3_subject: "Re: Flash Sale",
        email_sent3_body: "Do you ship to addresses that aren't stores? Asking because I need approximately 40 bags of those apple chips.<br><br>Thanks."
    },

    cs: {
        compose: "âœ¨ Napsat", inbox: "ğŸ’– PÅ™Ã­chozÃ­", starred: "â­ S hvÄ›zdou",
        sent: "ğŸ’… OdeslanÃ©", drafts: "ğŸ“ Koncepty", important: "ğŸ”¥ DÅ¯leÅ¾itÃ©",
        trash: "ğŸ—‘ï¸ KoÅ¡", labels: "Å tÃ­tky",
        personal: "OsobnÃ­", work: "PrÃ¡ce", hobby: "KonÃ­Äky", shopping: "NÃ¡kupy",
        search_mail: "Hledat v poÅ¡tÄ›...", select_all: "Vybrat vÅ¡e",
        delete: "ğŸ—‘ï¸ Smazat", mark_read: "âœ“ OznaÄit jako pÅ™eÄtenÃ©",
        star_btn: "â­ HvÄ›zda", reply: "â†©ï¸ OdpovÄ›dÄ›t", forward: "â¡ï¸ PÅ™eposlat",
        reply_placeholder: "NapiÅ¡ odpovÄ›Ä...", cancel: "ZruÅ¡it",
        send_reply: "Odeslat odpovÄ›Ä âœ¨", new_message: "âœ¨ NovÃ¡ zprÃ¡va",
        to_placeholder: "Komu:",
        subject_placeholder: "PÅ™edmÄ›t:",
        message_placeholder: "NapiÅ¡ zprÃ¡vu...",
        save_draft: "UloÅ¾it koncept", send: "Odeslat âœ¨",
        nothing_here: "Nic tu nenÃ­!",
        no_match: "Å½Ã¡dnÃ© emaily neodpovÃ­dajÃ­ hledÃ¡nÃ­.",
        folder_empty: "SloÅ¾ka je prÃ¡zdnÃ¡.",
        trash_empty: "KoÅ¡ je prÃ¡zdnÃ½! Jsi eko! â™»ï¸",

        toast_no_selected: "NemÃ¡Å¡ vybranÃ© Å¾Ã¡dnÃ© emaily!",
        toast_deleted_n: "SmazÃ¡no: {n} email(Å¯)!",
        toast_mark_read: "OznaÄeno jako pÅ™eÄtenÃ©!",
        toast_delete_confirm: "Smazat {n} email(Å¯)?",
        toast_delete_one_confirm: "Smazat tenhle email?",
        toast_write_first: "NejdÅ™Ã­v nÄ›co napiÅ¡!",
        toast_reply_sent: "OdpovÄ›Ä odeslÃ¡na!",
        toast_recipient_subject: "DoplÅˆ pÅ™Ã­jemce a pÅ™edmÄ›t!",
        toast_sent_manifest: "OdeslÃ¡no! Manifestujeme odpovÄ›Ä.",
        toast_nothing_save: "NenÃ­ co uklÃ¡dat!",
        toast_draft_saved: "Koncept uloÅ¾en!",
        toast_star_added: "PÅ™idÃ¡no do hvÄ›zd!",
        toast_star_removed: "OdebrÃ¡no z hvÄ›zd",

        soon_attach: "PÅ™Ã­lohy budou brzy!",
        soon_emoji: "VÃ½bÄ›r emoji bude brzy!",
        soon_schedule: "NaplÃ¡novanÃ© odeslÃ¡nÃ­ bude brzy!",

        // â”€â”€ PÅ˜ÃCHOZÃ EMAILY â”€â”€

        email1_subject: "ğŸ¾ Whippet Å¡tÄ›Åˆata â€” zbÃ½vÃ¡ 1",
        email1_body: "Ahoj!<br><br>SkvÄ›lÃ¡ zprÃ¡va â€” nÃ¡Å¡ nejnovÄ›jÅ¡Ã­ vrh whippetÅ¯ je skoro celÃ½ zarezervovanÃ½, ale <b>jedna blue fawn holÄiÄka</b> jeÅ¡tÄ› hledÃ¡ svÃ©ho ÄlovÄ›ka. MÃ¡ nejdelÅ¡Ã­ uÅ¡i, jakÃ½ jste kdy vidÄ›li, a uÅ¾ perfektnÄ› ovlÃ¡dÃ¡ klasickÃ½ whippetÃ­ bochnÃ­k na gauÄi.<br><br>Fotky v pÅ™Ã­loze. Dlouho tu nebude.<br><br>â€“ ChovatelskÃ¡ stanice Paws & Noses",

        email2_subject: "ğŸ‘ TrÃ©nink pÅ™esunut na 19:30",
        email2_body: "ÄŒau tÃ½m!<br><br>Hala je zase dvakrÃ¡t zarezervovanÃ¡ (pÅ™ekvapenÃ­ ğŸ™„). TrÃ©nink se posouvÃ¡ na <b>19:30</b>.<br><br>Vemte hokejky, vemte formu, vemte svaÄiny jestli jste Å¡tÄ›dÅ™Ã­.<br><br>VidÃ­me se! ğŸ’ª<br>â€“ TrenÃ©r K",

        email3_subject: "TvÅ¯j streak je v ohroÅ¾enÃ­ ğŸ”¥",
        email3_body: "Hej,<br><br>UÄÃ­Å¡ se Äesky uÅ¾ <b>47 dnÃ­ v kuse</b>. TeÄ to nezkazit. To je delÅ¡Ã­ neÅ¾ vÄ›tÅ¡ina novoroÄnÃ­ch pÅ™edsevzetÃ­.<br><br>DneÅ¡nÃ­ lekce: SlovÃ­Äka o jÃ­dle. KoneÄnÄ› se nauÄ, co si vlastnÄ› objednÃ¡vÃ¡Å¡ v restauracÃ­ch.<br><br>ğŸ¦‰ Duo",

        email4_subject: "âœ¨ ProÄ nepotÅ™ebujeÅ¡ dalÅ¡Ã­ sÃ©rum",
        email4_body: "NovÃ© video je venku:<br><br><b>&bdquo;MÅ¯j Low-Buy rok: Jak jsem uÅ¡etÅ™ila 10 000 KÄ a zlepÅ¡ila pleÅ¥&ldquo;</b><br><br>Spoiler: tajnÃ¡ ingredience je doslova jen voda a nechat obliÄej na pokoji. RevoluÄnÃ­, jÃ¡ vÃ­m.<br><br>MÄ›j se krÃ¡snÄ› (pÅ™irozenÄ›),<br>â€“ The Daily Glow",

        email5_subject: "ğŸ¼ KrmenÃ­ pand ÄervenÃ½ch â€” jsi pozvanÃ¡!",
        email5_body: "MilÃ¡ pÅ™Ã­telkynÄ›,<br><br>DÄ›kujeme za tvÅ¯j nedÃ¡vnÃ½ pÅ™Ã­spÄ›vek do Fondu na ochranu pandy ÄervenÃ©! ğŸ‰<br><br>Jako podÄ›kovÃ¡nÃ­ tÄ› zveme na <b>exkluzivnÃ­ zÃ¡kulisnÃ­ krmenÃ­</b> pÅ™Ã­Å¡tÃ­ mÄ›sÃ­c. PotkÃ¡Å¡ Bambuska a Mochi â€” naÅ¡e dvÄ› rezidentnÃ­ pandy, kterÃ© jsou v podstatÄ› profesionÃ¡lnÃ­ zlodÄ›ji svaÄin.<br><br>OdpovÄ›z prosÃ­m pro potvrzenÃ­ mÃ­sta.<br><br>â€“ TÃ½m ochrany pÅ™Ã­rody, Zoo Praha",

        email6_subject: "Fourth Wing zase trenduje ğŸ‰",
        email6_body: "Tvoje tÃ½dennÃ­ Goodreads novinky:<br><br>VÅ¡ichni co znÃ¡Å¡ Ätou <b>Fourth Wing</b>. Ty to mÃ¡Å¡ jako &bdquo;Chci pÅ™eÄÃ­st&ldquo; uÅ¾ 4 mÄ›sÃ­ce. KnÃ­Å¾ka na tebe zÃ­rÃ¡. SoudÃ­ tÄ›.<br><br>HodnocenÃ­: â­â­â­â­â­ (5,0)<br>NejlepÅ¡Ã­ recenze: <i>&bdquo;Doslova pikantnÃ­ Hunger Games s drakama. PÅ™eÄetla jsem to najednou a zapomnÄ›la jsem jÃ­st.&ldquo;</i><br><br>Ale Å¾Ã¡dnÃ½ tlak.",

        email7_subject: "Piny, co by se ti mohly lÃ­bit ğŸ“Œ",
        email7_body: "Podle tvÃ© nÃ¡stÄ›nky <b>&bdquo;BudoucÃ­ domov&ldquo;</b> jsme ti naÅ¡li:<br><br>â€¢ MinimalistickÃ© bÃ©Å¾ovÃ© obÃ½vÃ¡ky, co stojÃ­ vÃ­c neÅ¾ nÃ¡jem<br>â€¢ Fotky whippet Å¡tÄ›Åˆat (nemÃ¡Å¡ zaÄ)<br>â€¢ VeganskÃ½ meal prep, co fakt vypadÃ¡ jedlÄ›<br>â€¢ ÃštulnÃ© ÄtecÃ­ koutky, co si screenshotneÅ¡, ale nikdy nepostavÃ­Å¡<br><br>â€“ Pinterest",

        email8_subject: "NovÃ© Å¡ablony pro 2026 jsou tu",
        email8_body: "Zorganizuj si celou svou existenci s novÃ½m balÃ­Äkem Å¡ablon:<br><br>ğŸ“‹ Gym Tracker (na tu permanentku, co urÄitÄ› pouÅ¾Ã­vÃ¡Å¡)<br>ğŸ§´ Skincare Log (max 3 kroky, slibujeme)<br>ğŸ“š Seznam knih (aÅ¥ pÅ™estaneÅ¡ kupovat knÃ­Å¾ky, co uÅ¾ mÃ¡Å¡)<br>ğŸ• PÃ©Äe o mazlÃ­Äka Dashboard (ano, tohle teÄ existuje)<br><br>VÅ¡echno zdarma. Å½Ã¡dnÃ© vÃ½mluvy.<br>â€“ Notion",

        email9_subject: "20 % sleva na seamless legÃ­ny ğŸƒâ€â™€ï¸",
        email9_body: "Hele, vÃ­me, Å¾e mÃ¡Å¡ low-buy rok.<br><br>Ale tyhle legÃ­ny majÃ­ <b>kapsy</b>. OPRAVDOVÃ‰ kapsy. Na celÃ½ telefon.<br><br>20 % sleva jen tento vÃ­kend. KÃ³d: POCKETS20<br><br>Podporujeme tÄ› tak jako tak. ğŸ’ª<br>â€“ GymShark",

        email10_subject: "Tvoje ÃºnorovÃ© Wrapped ğŸµ",
        email10_body: "Tento mÄ›sÃ­c jsi poslouchala <b>12 458 minut</b> hudby. To je... hodnÄ›.<br><br>Tvoji top interpreti:<br>1. Taylor Swift (pÅ™ekvapenÃ­? nikoho)<br>2. Olivia Rodrigo<br>3. Sabrina Carpenter<br><br>Tvoje nÃ¡lada: <b>Main Character Energy</b> âœ¨<br>NejvÃ­c hrajeÅ¡ ve: 2:00 v noci (jsi v pohodÄ›?)<br><br>â€“ Spotify",

        email11_subject: "3 pozice, co sedÃ­ na tvÅ¯j profil ğŸ’¼",
        email11_body: "Podle tvÃ½ch skills jsme naÅ¡li tyhle role:<br><br>â€¢ <b>Senior TestovaÄka PostelÃ­</b> @ Google â€” Remote, skvÄ›lÃ© benefity<br>â€¢ <b>ProfesionÃ¡lnÃ­ KoordinÃ¡torka Å lofÃ­kÅ¯</b> @ Figma â€” FlexibilnÃ­ hodiny<br>â€¢ <b>Chief Sleep Officer</b> @ Notion â€” NeomezenÃ© volno<br><br>Dlouho tu nebudou. (StejnÄ› jako tvoje trpÄ›livost s LinkedIn emaily.)<br><br>â€“ LinkedIn",

        email12_subject: "âš¡ FLASH VÃPRODEJ: JableÄnÃ© chipsy",
        email12_body: "POZOR VÄšRNÃ ZÃKAZNÃKU,<br><br>Jen tento vÃ­kend: <b>JableÄnÃ© chipsy s 15% slevou</b> v Lidlu Ostrava.<br><br>UkaÅ¾ tenhle email u pokladny. Nebo si ho screenshotni. Nebo prostÄ› pÅ™ijÄ a doufej â€” upÅ™Ã­mnÄ›, pokladnÃ­ to nekontrolujÃ­.<br><br>ğŸ Lidl â€” VelkÃ½ na kvalitu, malÃ½ na ceny, stÅ™ednÃ­ na email marketing.",

        email13_subject: "ÄŒas na stÅ™ih? ğŸ’‡â€â™€ï¸",
        email13_body: "Ahoj!<br><br>UÅ¾ jsou 3 mÄ›sÃ­ce od tvÃ© poslednÃ­ nÃ¡vÅ¡tÄ›vy. Tvoje vlasy volaly â€” chybÃ­me jim. (DÄ›lÃ¡m si srandu. To by bylo creepy.)<br><br>Objednej se a dostaneÅ¡ <b>15 % slevu</b> na jakÃ©koliv Redken oÅ¡etÅ™enÃ­.<br><br>KÃ³d: FRESHCUT<br><br>â€“ Studio R, Praha",

        email14_subject: "NÄ›co jsi nechala v koÅ¡Ã­ku ğŸ‘€",
        email14_body: "Hej,<br><br>Ta <b>oversized deka-mikina</b> je poÅ™Ã¡d v tvÃ©m koÅ¡Ã­ku. UÅ¾ 3 dny. Je jÃ­ zima. Je osamÄ›lÃ¡.<br><br>Jen Å™Ã­kÃ¡me â€” doprava zdarma konÄÃ­ dnes v noci.<br><br>Å½Ã¡dnÃ½ tlak. (Trochu tlak.)<br><br>â€“ ASOS",

        email15_subject: "ğŸ§˜ TvÅ¯j tÃ½dennÃ­ wellness souhrn",
        email15_body: "Tady je tvÅ¯j tÃ½den v pÅ™ehledu:<br><br>ğŸƒ Kroky: 48 291 (pÄ›knÃ½!)<br>ğŸ˜´ PrÅ¯mÄ›r spÃ¡nku: 6,2 hodiny (nepÄ›knÃ½)<br>ğŸ’§ PÅ™Ã­jem vody: Kdo vÃ­, pÅ™estala jsi logovat v ÃºterÃ½<br>ğŸ§˜ Meditace: 0 minut (ta appka tam poÅ™Ã¡d je)<br><br>PokraÄuj! Nebo zaÄni. ObojÃ­ funguje.<br><br>â€“ Fitbit",

        // â”€â”€ ODESLANÃ‰ EMAILY â”€â”€

        email_sent1_subject: "Re: Whippet Å¡tÄ›Åˆata",
        email_sent1_body: "PROBOHA. ğŸ˜­<br><br>Ano prosÃ­m! StraÅ¡nÄ› moc ji chci vidÄ›t. Jde sobota rÃ¡no? UÅ¾ jsem citovÄ› pÅ™ipoutanÃ¡ jen z fotek.<br><br>ProsÃ­m nedejte ji nikomu jinÃ©mu.",

        email_sent2_subject: "Re: KrmenÃ­ pand",
        email_sent2_body: "ANO. Doslova mÃ¡m celÃ½ pÅ™Ã­Å¡tÃ­ mÄ›sÃ­c volnÃ½ kvÅ¯li tomuhle. Å˜eknÄ›te kdy a budu tam.<br><br>RychlÃ¡ otÃ¡zka: mÅ¯Å¾u breÄet, kdyÅ¾ je potkÃ¡m? PtÃ¡m se sama za sebe.",

        email_sent3_subject: "Re: Flash vÃ½prodej",
        email_sent3_body: "DoruÄujete i na adresy, co nejsou prodejny? PtÃ¡m se, protoÅ¾e potÅ™ebuju asi 40 balÃ­ÄkÅ¯ tÄ›ch jableÄnÃ½ch chipsÅ¯.<br><br>DÃ­ky."
    }
};
</script>

<script>
// i18n bridge - reads language from parent localStorage
(function() {
    const LANG = localStorage.getItem('heartosLang') || 'en';
    window.__lang = LANG;
    window.__t = function(key, vars) {
        const dict = window.__translations;
        if (!dict) return key;
        const lang = dict[LANG] || dict['en'];
        let out = (lang && lang[key]) || (dict['en'] && dict['en'][key]) || key;
        if (vars && typeof out === 'string') {
            Object.keys(vars).forEach(k => {
                out = out.replaceAll(`{${k}}`, String(vars[k]));
            });
        }
        return out;
    };
    window.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('[data-i18n]').forEach(function(el) {
            var key = el.getAttribute('data-i18n');
            var translated = window.__t(key);
            if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                el.placeholder = translated;
            } else {
                el.textContent = translated;
            }
        });
        document.querySelectorAll('[data-i18n-placeholder]').forEach(function(el) {
            el.placeholder = window.__t(el.getAttribute('data-i18n-placeholder'));
        });
        if (typeof window.__translateSite === 'function') {
            window.__translateSite();
        }
    });

    window.addEventListener('storage', function(e){
        if(e.key === 'heartosLang'){
            location.reload();
        }
    });
})();
</script>

<script>
    window.__translateSite = function() {
        var t = window.__t;

        var cb = document.querySelector('.compose-btn');
        if(cb) cb.textContent = t('compose');

        var navs = document.querySelectorAll('.nav-section:first-of-type .nav-item span:first-child');
        var navKeys = ['inbox','starred','sent','drafts','important','trash'];
        navs.forEach(function(el,i){ if(navKeys[i]) el.textContent = t(navKeys[i]); });

        var lt = document.querySelector('.nav-section:nth-of-type(2) .nav-section-title');
        if(lt) lt.textContent = t('labels');

        var labels = document.querySelectorAll('.label-item span:last-child');
        var labelKeys = ['personal','work','hobby','shopping'];
        labels.forEach(function(el,i){ if(labelKeys[i]) el.textContent = t(labelKeys[i]); });

        var si = document.getElementById('search-input');
        if(si) si.placeholder = t('search_mail');

        var tbs = document.querySelectorAll('.toolbar-btn');
        if(tbs[0]) tbs[0].textContent = t('select_all');
        if(tbs[1]) tbs[1].textContent = t('delete');
        if(tbs[2]) tbs[2].textContent = t('mark_read');

        var vas = document.querySelectorAll('.view-actions .action-btn');
        if(vas[0]) vas[0].textContent = t('star_btn');
        if(vas[1]) vas[1].textContent = t('delete');

        var rp = document.getElementById('reply-text');
        if(rp) rp.placeholder = t('reply_placeholder');

        var rc = document.querySelector('.reply-actions .btn-cancel');
        if(rc) rc.textContent = t('cancel');

        var rs = document.querySelector('.reply-actions .btn-send');
        if(rs) rs.textContent = t('send_reply');

        var bottomBtns = document.querySelectorAll('#view > div:last-child .action-btn');
        if(bottomBtns[0]) bottomBtns[0].textContent = t('reply');
        if(bottomBtns[1]) bottomBtns[1].textContent = t('forward');

        var ch = document.querySelector('.compose-header span:first-child');
        if(ch) ch.textContent = t('new_message');

        var cto = document.getElementById('c-to');
        if(cto) cto.placeholder = t('to_placeholder');

        var csub = document.getElementById('c-sub');
        if(csub) csub.placeholder = t('subject_placeholder');

        var cmsg = document.getElementById('c-msg');
        if(cmsg) cmsg.placeholder = t('message_placeholder');

        var sd = document.querySelector('.c-footer-right .btn-cancel');
        if(sd) sd.textContent = t('save_draft');

        var se = document.querySelector('.c-footer-right .btn-send');
        if(se) se.textContent = t('send');
    };
</script>

</head>
<body>
    <div class="app-container">
        <div class="sidebar">
            <div class="logo">ğŸ’Œ HeartMail</div>
            <button class="compose-btn" onclick="openCompose()">âœ¨ Compose</button>
            
            <div class="nav-section">
                <div class="nav-item active" onclick="switchFolder('inbox', this)">
                    <span>ğŸ’– Inbox</span> <span id="count-inbox" class="badge" style="display:none;"></span>
                </div>
                <div class="nav-item" onclick="switchFolder('starred', this)">
                    <span>â­ Starred</span> <span id="count-starred"></span>
                </div>
                <div class="nav-item" onclick="switchFolder('sent', this)">
                    <span>ğŸ’… Sent</span> <span id="count-sent"></span>
                </div>
                <div class="nav-item" onclick="switchFolder('drafts', this)">
                    <span>ğŸ“ Drafts</span> <span id="count-drafts"></span>
                </div>
                <div class="nav-item" onclick="switchFolder('important', this)">
                    <span>ğŸ”¥ Important</span> <span id="count-important"></span>
                </div>
                <div class="nav-item" onclick="alert(window.__t('trash_empty'))">
                    <span>ğŸ—‘ï¸ Trash</span>
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Labels</div>
                <div class="label-item" onclick="filterByLabel('personal')">
                    <div class="label-dot" style="background: #ff9a9e;"></div>
                    <span>Personal</span>
                </div>
                <div class="label-item" onclick="filterByLabel('work')">
                    <div class="label-dot" style="background: #a8dadc;"></div>
                    <span>Work</span>
                </div>
                <div class="label-item" onclick="filterByLabel('hobby')">
                    <div class="label-dot" style="background: #ffd166;"></div>
                    <span>Hobby</span>
                </div>
                <div class="label-item" onclick="filterByLabel('shopping')">
                    <div class="label-dot" style="background: #9d84b7;"></div>
                    <span>Shopping</span>
                </div>
            </div>
        </div>

        <div class="main">
            <div class="toolbar">
                <div class="search-box">
                    <span class="search-icon">ğŸ”</span>
                    <input type="text" id="search-input" placeholder="Search mail..." onkeyup="searchEmails()" />
                </div>
                <button class="toolbar-btn" onclick="toggleSelectAll()">Select All</button>
                <button class="toolbar-btn" onclick="deleteSelected()">ğŸ—‘ï¸ Delete</button>
                <button class="toolbar-btn" onclick="markAsRead()">âœ“ Mark Read</button>
            </div>

            <div id="list" class="email-list"></div>

            <div id="view" class="email-view">
                <div class="view-header">
                    <div class="view-title">
                        <button class="back-btn" onclick="closeEmail()">âœ</button>
                        <h2 id="e-subject" style="display:inline; margin:0; color: #ff4d6d;">Subject</h2>
                    </div>
                    <div class="view-actions">
                        <button class="action-btn" onclick="starCurrentEmail()">â­ Star</button>
                        <button class="action-btn" onclick="deleteCurrentEmail()">ğŸ—‘ï¸ Delete</button>
                    </div>
                </div>
                <div style="display: flex; gap: 15px; margin-bottom: 20px; align-items: center;">
                    <div class="avatar" id="e-avatar">A</div>
                    <div>
                        <div id="e-sender" style="font-weight: bold; font-size: 1.1rem;">Sender</div>
                        <div style="color: #ff8fa3; font-size: 0.9rem;" id="e-date">Date</div>
                    </div>
                </div>
                <div id="e-body"></div>
                <div id="e-attachment"></div>
                
                <div class="reply-box" id="reply-box" style="display: none;">
                    <textarea class="reply-textarea" id="reply-text" placeholder="Type your reply..."></textarea>
                    <div class="reply-actions">
                        <button class="btn-cancel" onclick="cancelReply()">Cancel</button>
                        <button class="btn-send" onclick="sendReply()">Send Reply âœ¨</button>
                    </div>
                </div>
                
                <div style="margin-top: 20px;">
                    <button class="action-btn" onclick="showReplyBox()">â†©ï¸ Reply</button>
                    <button class="action-btn" onclick="forwardEmail()">â¡ï¸ Forward</button>
                </div>
            </div>
        </div>
    </div>

    <div id="compose-modal" class="modal-overlay">
        <div class="compose-box">
            <div class="compose-header">
                <span>âœ¨ New Message</span>
                <span style="cursor:pointer; font-size: 1.5rem;" onclick="closeCompose()">Ã—</span>
            </div>
            <div class="compose-form">
                <input id="c-to" class="c-input" placeholder="To: (e.g., Babe, Mom, Coach)" />
                <input id="c-sub" class="c-input" placeholder="Subject:" />
                <textarea id="c-msg" class="c-input c-body" placeholder="Type your message here..."></textarea>
                <div class="c-footer">
                    <div class="c-footer-left">
                        <button class="icon-btn" title="Attach file" onclick="showToast(window.__t('soon_attach'), 'ğŸ“')">ğŸ“</button>
                        <button class="icon-btn" title="Add emoji" onclick="showToast(window.__t('soon_emoji'), 'ğŸ˜Š')">ğŸ˜Š</button>
                        <button class="icon-btn" title="Schedule send" onclick="showToast(window.__t('soon_schedule'), 'â°')">â°</button>
                    </div>
                    <div class="c-footer-right">
                        <button class="btn-cancel" onclick="saveDraft()">Save Draft</button>
                        <button class="btn-send" onclick="sendEmail()">Send âœ¨</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="toast" id="toast">
        <span id="toast-icon" style="font-size: 1.5rem;">âœ¨</span>
        <span id="toast-message">Message sent!</span>
    </div>

    <script>
        let emailData = [
            { id: 1, folder: 'inbox', starred: true, read: false, sender: "Paws & Noses", date: "11:02 AM", label: "personal",
              i18n: { subject: "email1_subject", body: "email1_body" }, attachment: "puppy_photos.zip", important: true },

            { id: 2, folder: 'inbox', starred: false, read: false, sender: "Cape Floorball", date: "10:15 AM", label: "hobby",
              i18n: { subject: "email2_subject", body: "email2_body" }, attachment: null, important: false },

            { id: 3, folder: 'inbox', starred: false, read: false, sender: "Duolingo", date: "9:30 AM", label: "hobby",
              i18n: { subject: "email3_subject", body: "email3_body" }, attachment: null, important: false },

            { id: 4, folder: 'inbox', starred: false, read: true, sender: "The Daily Glow", date: "Yesterday", label: "hobby",
              i18n: { subject: "email4_subject", body: "email4_body" }, attachment: null, important: false },

            { id: 5, folder: 'inbox', starred: true, read: true, sender: "Prague Zoo", date: "Yesterday", label: "personal",
              i18n: { subject: "email5_subject", body: "email5_body" }, attachment: null, important: true },

            { id: 6, folder: 'inbox', starred: false, read: true, sender: "Goodreads", date: "Feb 10", label: "hobby",
              i18n: { subject: "email6_subject", body: "email6_body" }, attachment: null, important: false },

            { id: 7, folder: 'inbox', starred: false, read: true, sender: "Pinterest", date: "Feb 9", label: "hobby",
              i18n: { subject: "email7_subject", body: "email7_body" }, attachment: null, important: false },

            { id: 8, folder: 'inbox', starred: false, read: true, sender: "Notion", date: "Feb 8", label: "work",
              i18n: { subject: "email8_subject", body: "email8_body" }, attachment: null, important: false },

            { id: 9, folder: 'inbox', starred: false, read: true, sender: "GymShark", date: "Feb 7", label: "shopping",
              i18n: { subject: "email9_subject", body: "email9_body" }, attachment: null, important: false },

            { id: 10, folder: 'inbox', starred: false, read: true, sender: "Spotify", date: "Feb 6", label: "personal",
              i18n: { subject: "email10_subject", body: "email10_body" }, attachment: null, important: false },

            { id: 11, folder: 'inbox', starred: false, read: true, sender: "LinkedIn", date: "Feb 5", label: "work",
              i18n: { subject: "email11_subject", body: "email11_body" }, attachment: null, important: false },

            { id: 12, folder: 'inbox', starred: false, read: true, sender: "Lidl", date: "Feb 4", label: "shopping",
              i18n: { subject: "email12_subject", body: "email12_body" }, attachment: null, important: false },

            { id: 13, folder: 'inbox', starred: false, read: true, sender: "Studio R", date: "Feb 3", label: "personal",
              i18n: { subject: "email13_subject", body: "email13_body" }, attachment: null, important: false },

            { id: 14, folder: 'inbox', starred: false, read: true, sender: "ASOS", date: "Feb 2", label: "shopping",
              i18n: { subject: "email14_subject", body: "email14_body" }, attachment: null, important: false },

            { id: 15, folder: 'inbox', starred: false, read: true, sender: "Fitbit", date: "Feb 1", label: "hobby",
              i18n: { subject: "email15_subject", body: "email15_body" }, attachment: null, important: false },

            // Sent
            { id: 101, folder: 'sent', starred: false, read: true, sender: "Me", date: "11:15 AM", label: "personal",
              i18n: { subject: "email_sent1_subject", body: "email_sent1_body" }, attachment: null, important: false },

            { id: 102, folder: 'sent', starred: false, read: true, sender: "Me", date: "Yesterday", label: "personal",
              i18n: { subject: "email_sent2_subject", body: "email_sent2_body" }, attachment: null, important: false },

            { id: 103, folder: 'sent', starred: false, read: true, sender: "Me", date: "Feb 4", label: "shopping",
              i18n: { subject: "email_sent3_subject", body: "email_sent3_body" }, attachment: null, important: false }
        ];

        let currentFolder = 'inbox';
        let currentEmailId = null;
        let selectedEmails = new Set();
        let currentLabelFilter = null;

        function emailSubject(email) {
            if (email.subject) return email.subject;
            return window.__t(email?.i18n?.subject || '');
        }
        function emailBody(email) {
            if (email.body) return email.body;
            return window.__t(email?.i18n?.body || '');
        }
        function labelDisplay(labelKey) {
            return window.__t(labelKey || '');
        }

        function renderList() {
            const listEl = document.getElementById('list');
            listEl.innerHTML = "";
            selectedEmails.clear();

            const searchTerm = document.getElementById('search-input').value.toLowerCase();

            let filtered = [];
            if (currentFolder === 'starred') {
                filtered = emailData.filter(e => e.starred);
            } else if (currentFolder === 'important') {
                filtered = emailData.filter(e => e.important);
            } else {
                filtered = emailData.filter(e => e.folder === currentFolder);
            }

            if (currentLabelFilter) {
                filtered = filtered.filter(e => e.label === currentLabelFilter);
            }

            if (searchTerm) {
                filtered = filtered.filter(e => 
                    (e.sender || '').toLowerCase().includes(searchTerm) ||
                    emailSubject(e).toLowerCase().includes(searchTerm) ||
                    stripHtml(emailBody(e)).toLowerCase().includes(searchTerm)
                );
            }

            const unreadInbox = emailData.filter(e => e.folder === 'inbox' && !e.read).length;
            const badgeEl = document.getElementById('count-inbox');
            if (unreadInbox > 0) {
                badgeEl.innerText = unreadInbox;
                badgeEl.style.display = 'inline-block';
            } else {
                badgeEl.style.display = 'none';
            }
            
            document.getElementById('count-starred').innerText = emailData.filter(e => e.starred).length || "";
            document.getElementById('count-sent').innerText = emailData.filter(e => e.folder === 'sent').length || "";
            document.getElementById('count-drafts').innerText = emailData.filter(e => e.folder === 'drafts').length || "";
            document.getElementById('count-important').innerText = emailData.filter(e => e.important).length || "";

            filtered.forEach(email => {
                const item = document.createElement('div');
                item.className = `email-item ${email.read ? '' : 'unread'}`;
                item.onclick = (e) => {
                    if(!e.target.classList.contains('star-btn') && !e.target.classList.contains('checkbox')) {
                        openEmail(email.id);
                    }
                };

                const starClass = email.starred ? 'star-btn active' : 'star-btn';
                const starIcon = email.starred ? 'â˜…' : 'â˜†';

                let labelTag = '';
                if (email.label) {
                    const labelColors = {
                        personal: '#ff9a9e',
                        work: '#a8dadc',
                        hobby: '#ffd166',
                        shopping: '#9d84b7'
                    };
                    labelTag = `<span class="label-tag" style="background: ${labelColors[email.label]}20; color: ${labelColors[email.label]};">${labelDisplay(email.label)}</span>`;
                }

                const subj = emailSubject(email);
                const bodyPlain = stripHtml(emailBody(email));
                const previewText = bodyPlain.substring(0, 40);

                item.innerHTML = `
                    <input type="checkbox" class="checkbox" onchange="toggleSelect(${email.id}, this.checked)" />
                    <div class="${starClass}" onclick="toggleStar(${email.id}, this)">${starIcon}</div>
                    <div class="sender">${email.sender}</div>
                    <div class="subject">${escapeHtml(subj)} ${labelTag}<span class="preview"> - ${escapeHtml(previewText)}...</span></div>
                    <div class="date">${email.date}</div>
                `;
                listEl.appendChild(item);
            });

            if(filtered.length === 0) {
                const emptyTitle = window.__t('nothing_here');
                const emptyDesc = searchTerm ? window.__t('no_match') : window.__t('folder_empty');
                listEl.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“­</div>
                        <div style="font-size: 1.2rem; margin-bottom: 10px;">${escapeHtml(emptyTitle)}</div>
                        <div style="font-size: 0.9rem;">${escapeHtml(emptyDesc)}</div>
                    </div>
                `;
            }
        }

        function switchFolder(folder, btn) {
            currentFolder = folder;
            currentLabelFilter = null;
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            btn.classList.add('active');
            document.querySelectorAll('.label-item').forEach(el => el.style.background = 'transparent');
            closeEmail();
            renderList();
        }

        function filterByLabel(label) {
            currentLabelFilter = label;
            currentFolder = 'inbox';
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.label-item').forEach(el => el.style.background = 'transparent');
            event.target.closest('.label-item').style.background = 'rgba(255, 255, 255, 0.5)';
            closeEmail();
            renderList();
        }

        function toggleStar(id, btn) {
            const email = emailData.find(e => e.id === id);
            email.starred = !email.starred;
            renderList();
        }

        function toggleSelect(id, checked) {
            if (checked) selectedEmails.add(id);
            else selectedEmails.delete(id);
        }

        function toggleSelectAll() {
            const checkboxes = document.querySelectorAll('.checkbox');
            const allChecked = Array.from(checkboxes).every(cb => cb.checked);
            checkboxes.forEach(cb => {
                cb.checked = !allChecked;
                const emailItem = cb.closest('.email-item');
                const emailId = parseInt(emailItem.querySelector('.star-btn').getAttribute('onclick').match(/\d+/)[0]);
                toggleSelect(emailId, cb.checked);
            });
        }

        function deleteSelected() {
            if (selectedEmails.size === 0) { showToast(window.__t('toast_no_selected'), 'âš ï¸'); return; }
            const n = selectedEmails.size;
            if (confirm(window.__t('toast_delete_confirm', { n }))) {
                emailData = emailData.filter(e => !selectedEmails.has(e.id));
                selectedEmails.clear();
                renderList();
                showToast(window.__t('toast_deleted_n', { n }), 'âœ“');
            }
        }

        function markAsRead() {
            if (selectedEmails.size === 0) { showToast(window.__t('toast_no_selected'), 'âš ï¸'); return; }
            selectedEmails.forEach(id => {
                const email = emailData.find(e => e.id === id);
                if (email) email.read = true;
            });
            selectedEmails.clear();
            renderList();
            showToast(window.__t('toast_mark_read'), 'âœ“');
        }

        function searchEmails() { renderList(); }

        function openEmail(id) {
            const email = emailData.find(e => e.id === id);
            currentEmailId = id;
            if (!email.read && email.folder === 'inbox') { email.read = true; renderList(); }
            document.getElementById('list').style.display = 'none';
            document.getElementById('view').style.display = 'flex';
            document.getElementById('e-subject').innerText = emailSubject(email);
            document.getElementById('e-sender').innerText = email.sender;
            document.getElementById('e-date').innerText = email.date;
            document.getElementById('e-body').innerHTML = emailBody(email);
            document.getElementById('e-avatar').innerText = (email.sender && email.sender[0]) ? email.sender[0] : '?';
            const attachmentEl = document.getElementById('e-attachment');
            attachmentEl.innerHTML = email.attachment ? `<div class="attachment">ğŸ“ ${escapeHtml(email.attachment)}</div>` : '';
            document.getElementById('reply-box').style.display = 'none';
        }

        function closeEmail() {
            document.getElementById('view').style.display = 'none';
            document.getElementById('list').style.display = 'block';
            currentEmailId = null;
        }

        function starCurrentEmail() {
            if (!currentEmailId) return;
            const email = emailData.find(e => e.id === currentEmailId);
            email.starred = !email.starred;
            showToast(email.starred ? window.__t('toast_star_added') : window.__t('toast_star_removed'), email.starred ? 'â­' : 'â„¹ï¸');
            renderList();
        }

        function deleteCurrentEmail() {
            if (!currentEmailId) return;
            if (confirm(window.__t('toast_delete_one_confirm'))) {
                emailData = emailData.filter(e => e.id !== currentEmailId);
                closeEmail();
                renderList();
                showToast(window.__t('delete'), 'âœ“');
            }
        }

        function showReplyBox() {
            document.getElementById('reply-box').style.display = 'block';
            document.getElementById('reply-text').focus();
        }

        function cancelReply() {
            document.getElementById('reply-box').style.display = 'none';
            document.getElementById('reply-text').value = '';
        }

        function sendReply() {
            const replyText = document.getElementById('reply-text').value;
            if (!replyText.trim()) { showToast(window.__t('toast_write_first'), 'âš ï¸'); return; }
            const originalEmail = emailData.find(e => e.id === currentEmailId);
            const newEmail = {
                id: Date.now(), folder: 'sent', starred: false, read: true, sender: "Me",
                subject: `Re: ${emailSubject(originalEmail)}`, date: "Just now",
                label: originalEmail.label, body: replyText.replace(/\n/g, "<br>"),
                attachment: null, important: false
            };
            emailData.unshift(newEmail);
            cancelReply();
            showToast(window.__t('toast_reply_sent'), 'âœ“');
            if (currentFolder === 'sent') renderList();
        }

        function forwardEmail() {
            if (!currentEmailId) return;
            const email = emailData.find(e => e.id === currentEmailId);
            document.getElementById('c-to').value = '';
            document.getElementById('c-sub').value = `Fwd: ${emailSubject(email)}`;
            document.getElementById('c-msg').value = `\n\n--- Forwarded message ---\nFrom: ${email.sender}\nSubject: ${emailSubject(email)}\n\n${stripHtml(emailBody(email))}`;
            openCompose();
        }

        function openCompose() { document.getElementById('compose-modal').style.display = 'flex'; }

        function closeCompose() {
            document.getElementById('compose-modal').style.display = 'none';
            document.getElementById('c-to').value = "";
            document.getElementById('c-sub').value = "";
            document.getElementById('c-msg').value = "";
        }

        function sendEmail() {
            const to = document.getElementById('c-to').value;
            const sub = document.getElementById('c-sub').value;
            const body = document.getElementById('c-msg').value;
            if (!to || !sub) { showToast(window.__t('toast_recipient_subject'), 'âš ï¸'); return; }
            emailData.unshift({
                id: Date.now(), folder: 'sent', starred: false, read: true, sender: "Me",
                subject: `To: ${to} - ${sub}`, date: "Just now", label: "personal",
                body: body.replace(/\n/g, "<br>"), attachment: null, important: false
            });
            closeCompose();
            showToast(window.__t('toast_sent_manifest'), 'âœ“');
            if (currentFolder === 'sent') renderList();
        }

        function saveDraft() {
            const to = document.getElementById('c-to').value;
            const sub = document.getElementById('c-sub').value;
            const body = document.getElementById('c-msg').value;
            if (!to && !sub && !body) { showToast(window.__t('toast_nothing_save'), 'âš ï¸'); return; }
            emailData.unshift({
                id: Date.now(), folder: 'drafts', starred: false, read: true, sender: "Me (Draft)",
                subject: sub || "(No subject)", date: "Just now", label: "personal",
                body: body.replace(/\n/g, "<br>") || "(Empty draft)", attachment: null, important: false
            });
            closeCompose();
            showToast(window.__t('toast_draft_saved'), 'âœ“');
            renderList();
        }

        function showToast(message, icon = 'âœ¨') {
            const toast = document.getElementById('toast');
            document.getElementById('toast-message').innerText = message;
            document.getElementById('toast-icon').innerText = icon;
            toast.style.display = 'flex';
            setTimeout(() => { toast.style.display = 'none'; }, 3000);
        }

        function stripHtml(html) {
           let tmp = document.createElement("DIV");
           tmp.innerHTML = html;
           return tmp.textContent || tmp.innerText || "";
        }

        function escapeHtml(str) {
            if (str === null || str === undefined) return '';
            return String(str).replaceAll('&', '&amp;').replaceAll('<', '&lt;').replaceAll('>', '&gt;').replaceAll('"', '&quot;').replaceAll("'", '&#039;');
        }

        renderList();
    </script>
</body>
</html>